{"remainingRequest":"C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\webchat\\chatApp\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\webchat\\chatApp\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\webchat\\chatApp\\src\\firebase.js","dependencies":[{"path":"C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\webchat\\chatApp\\src\\firebase.js","mtime":1709885820998},{"path":"C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\webchat\\chatApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709867558250},{"path":"C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\webchat\\chatApp\\node_modules\\babel-loader\\lib\\index.js","mtime":1709867558242},{"path":"C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\webchat\\chatApp\\node_modules\\eslint-loader\\index.js","mtime":1709867596137}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovVXNlcnMvdHVhbnR2L0Rlc2t0b3AvU3R1ZHlDb2RlL0ludGVybi93ZWJjaGF0L2NoYXRBcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJDOi9Vc2Vycy90dWFudHYvRGVza3RvcC9TdHVkeUNvZGUvSW50ZXJuL3dlYmNoYXQvY2hhdEFwcC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBmaXJlYmFzZSBmcm9tICdmaXJlYmFzZS9hcHAnOwppbXBvcnQgJ2ZpcmViYXNlL2F1dGgnOwppbXBvcnQgJ2ZpcmViYXNlL2ZpcmVzdG9yZSc7CmltcG9ydCBGaWx0ZXIgZnJvbSAnYmFkLXdvcmRzJzsKaW1wb3J0IHsgcmVmLCBvblVubW91bnRlZCwgY29tcHV0ZWQgfSBmcm9tICd2dWUnOwpmaXJlYmFzZS5pbml0aWFsaXplQXBwKHsKICBhcGlLZXk6ICJBSXphU3lBcEEtOGUwUWhqMkNuRlhNM2czc1gwUDl2NW5vOE9OYlkiLAogIGF1dGhEb21haW46ICJ0ZXN0LWZpcmViYXNlLTItZWVmMWMuZmlyZWJhc2VhcHAuY29tIiwKICBkYXRhYmFzZVVSTDogImh0dHBzOi8vdGVzdC1maXJlYmFzZS0yLWVlZjFjLWRlZmF1bHQtcnRkYi5hc2lhLXNvdXRoZWFzdDEuZmlyZWJhc2VkYXRhYmFzZS5hcHAiLAogIHByb2plY3RJZDogInRlc3QtZmlyZWJhc2UtMi1lZWYxYyIsCiAgc3RvcmFnZUJ1Y2tldDogInRlc3QtZmlyZWJhc2UtMi1lZWYxYy5hcHBzcG90LmNvbSIsCiAgbWVzc2FnaW5nU2VuZGVySWQ6ICI3NjUyMTQ5NjkxNDgiLAogIGFwcElkOiAiMTo3NjUyMTQ5NjkxNDg6d2ViOjAyYzY0ZmYyMWFiZDhjOTlmYTIyMzkiLAogIG1lYXN1cmVtZW50SWQ6ICJHLVZINUpDSlFUMUUiCn0pOwp2YXIgYXV0aCA9IGZpcmViYXNlLmF1dGgoKTsKZXhwb3J0IGZ1bmN0aW9uIHVzZUF1dGgoKSB7CiAgdmFyIHVzZXIgPSByZWYobnVsbCk7CiAgdmFyIHVuc3Vic2NyaWJlID0gYXV0aC5vbkF1dGhTdGF0ZUNoYW5nZWQoZnVuY3Rpb24gKF91c2VyKSB7CiAgICByZXR1cm4gdXNlci52YWx1ZSA9IF91c2VyOwogIH0pOwogIG9uVW5tb3VudGVkKHVuc3Vic2NyaWJlKTsKICB2YXIgaXNMb2dpbiA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB1c2VyLnZhbHVlICE9PSBudWxsOwogIH0pOwoKICB2YXIgc2lnbkluID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICB2YXIgZ29vZ2xlUHJvdmlkZXI7CiAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBnb29nbGVQcm92aWRlciA9IG5ldyBmaXJlYmFzZS5hdXRoLkdvb2dsZUF1dGhQcm92aWRlcigpOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBhdXRoLnNpZ25JbldpdGhQb3B1cChnb29nbGVQcm92aWRlcik7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpOwoKICAgIHJldHVybiBmdW5jdGlvbiBzaWduSW4oKSB7CiAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0oKTsKCiAgdmFyIHNpZ25PdXQgPSBmdW5jdGlvbiBzaWduT3V0KCkgewogICAgcmV0dXJuIGF1dGguc2lnbk91dCgpOwogIH07CgogIHJldHVybiB7CiAgICB1c2VyOiB1c2VyLAogICAgaXNMb2dpbjogaXNMb2dpbiwKICAgIHNpZ25Jbjogc2lnbkluLAogICAgc2lnbk91dDogc2lnbk91dAogIH07Cn0KdmFyIGZpcmVzdG9yZSA9IGZpcmViYXNlLmZpcmVzdG9yZSgpOwp2YXIgbWVzc2FnZXNDb2xsZWN0aW9uID0gZmlyZXN0b3JlLmNvbGxlY3Rpb24oJ21lc3NhZ2VzJyk7CnZhciBtZXNzYWdlc1F1ZXJ5ID0gbWVzc2FnZXNDb2xsZWN0aW9uLm9yZGVyQnkoJ2NyZWF0ZWRBdCcsICdkZXNjJykubGltaXQoMTAwKTsKdmFyIGZpbHRlciA9IG5ldyBGaWx0ZXIoKTsKZXhwb3J0IGZ1bmN0aW9uIHVzZUNoYXQoKSB7CiAgdmFyIG1lc3NhZ2VzID0gcmVmKFtdKTsKICB2YXIgdW5zdWJzY3JpYmUgPSBtZXNzYWdlc1F1ZXJ5Lm9uU25hcHNob3QoZnVuY3Rpb24gKHNuYXBzaG90KSB7CiAgICBtZXNzYWdlcy52YWx1ZSA9IHNuYXBzaG90LmRvY3MubWFwKGZ1bmN0aW9uIChkb2MpIHsKICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoewogICAgICAgIGlkOiBkb2MuaWQKICAgICAgfSwgZG9jLmRhdGEoKSk7CiAgICB9KS5yZXZlcnNlKCk7CiAgfSk7CiAgb25Vbm1vdW50ZWQodW5zdWJzY3JpYmUpOwoKICB2YXIgX3VzZUF1dGggPSB1c2VBdXRoKCksCiAgICAgIHVzZXIgPSBfdXNlQXV0aC51c2VyLAogICAgICBpc0xvZ2luID0gX3VzZUF1dGguaXNMb2dpbjsKCiAgdmFyIHNlbmRNZXNzYWdlID0gZnVuY3Rpb24gc2VuZE1lc3NhZ2UodGV4dCkgewogICAgaWYgKCFpc0xvZ2luLnZhbHVlKSByZXR1cm47CiAgICB2YXIgX3VzZXIkdmFsdWUgPSB1c2VyLnZhbHVlLAogICAgICAgIHBob3RvVVJMID0gX3VzZXIkdmFsdWUucGhvdG9VUkwsCiAgICAgICAgdWlkID0gX3VzZXIkdmFsdWUudWlkLAogICAgICAgIGRpc3BsYXlOYW1lID0gX3VzZXIkdmFsdWUuZGlzcGxheU5hbWU7CiAgICBtZXNzYWdlc0NvbGxlY3Rpb24uYWRkKHsKICAgICAgdXNlck5hbWU6IGRpc3BsYXlOYW1lLAogICAgICB1c2VySWQ6IHVpZCwKICAgICAgdXNlclBob3RvVVJMOiBwaG90b1VSTCwKICAgICAgdGV4dDogZmlsdGVyLmNsZWFuKHRleHQpLAogICAgICBjcmVhdGVkQXQ6IGZpcmViYXNlLmZpcmVzdG9yZS5GaWVsZFZhbHVlLnNlcnZlclRpbWVzdGFtcCgpCiAgICB9KTsKICB9OwoKICByZXR1cm4gewogICAgbWVzc2FnZXM6IG1lc3NhZ2VzLAogICAgc2VuZE1lc3NhZ2U6IHNlbmRNZXNzYWdlCiAgfTsKfQ=="},{"version":3,"sources":["C:/Users/tuantv/Desktop/StudyCode/Intern/webchat/chatApp/src/firebase.js"],"names":["firebase","Filter","ref","onUnmounted","computed","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","auth","useAuth","user","unsubscribe","onAuthStateChanged","_user","value","isLogin","signIn","googleProvider","GoogleAuthProvider","signInWithPopup","signOut","firestore","messagesCollection","collection","messagesQuery","orderBy","limit","filter","useChat","messages","onSnapshot","snapshot","docs","map","doc","id","data","reverse","sendMessage","text","photoURL","uid","displayName","add","userName","userId","userPhotoURL","clean","createdAt","FieldValue","serverTimestamp"],"mappings":"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","sourcesContent":["import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\n\r\nimport Filter from 'bad-words'\r\nimport { ref, onUnmounted, computed } from 'vue'\r\n\r\nfirebase.initializeApp({\r\n  apiKey: \"AIzaSyApA-8e0Qhj2CnFXM3g3sX0P9v5no8ONbY\",\r\n  authDomain: \"test-firebase-2-eef1c.firebaseapp.com\",\r\n  databaseURL: \"https://test-firebase-2-eef1c-default-rtdb.asia-southeast1.firebasedatabase.app\",\r\n  projectId: \"test-firebase-2-eef1c\",\r\n  storageBucket: \"test-firebase-2-eef1c.appspot.com\",\r\n  messagingSenderId: \"765214969148\",\r\n  appId: \"1:765214969148:web:02c64ff21abd8c99fa2239\",\r\n  measurementId: \"G-VH5JCJQT1E\"\r\n})\r\n\r\nconst auth = firebase.auth()\r\n\r\nexport function useAuth() {\r\n  const user = ref(null)\r\n  const unsubscribe = auth.onAuthStateChanged(_user => (user.value = _user))\r\n  onUnmounted(unsubscribe)\r\n  const isLogin = computed(() => user.value !== null)\r\n\r\n  const signIn = async () => {\r\n    const googleProvider = new firebase.auth.GoogleAuthProvider()\r\n    await auth.signInWithPopup(googleProvider)\r\n  }\r\n  const signOut = () => auth.signOut()\r\n\r\n  return { user, isLogin, signIn, signOut }\r\n}\r\n\r\nconst firestore = firebase.firestore()\r\nconst messagesCollection = firestore.collection('messages')\r\nconst messagesQuery = messagesCollection.orderBy('createdAt', 'desc').limit(100)\r\nconst filter = new Filter()\r\n\r\nexport function useChat() {\r\n  const messages = ref([])\r\n  const unsubscribe = messagesQuery.onSnapshot(snapshot => {\r\n    messages.value = snapshot.docs\r\n      .map(doc => ({ id: doc.id, ...doc.data() }))\r\n      .reverse()\r\n  })\r\n  onUnmounted(unsubscribe)\r\n\r\n  const { user, isLogin } = useAuth()\r\n  const sendMessage = text => {\r\n    if (!isLogin.value) return\r\n    const { photoURL, uid, displayName } = user.value\r\n    messagesCollection.add({\r\n      userName: displayName,\r\n      userId: uid,\r\n      userPhotoURL: photoURL,\r\n      text: filter.clean(text),\r\n      createdAt: firebase.firestore.FieldValue.serverTimestamp()\r\n    })\r\n  }\r\n\r\n  return { messages, sendMessage }\r\n}\r\n"]}]}