{"remainingRequest":"C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\appchat\\vue-realtime-chat\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\appchat\\vue-realtime-chat\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\appchat\\vue-realtime-chat\\src\\firebase.js","dependencies":[{"path":"C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\appchat\\vue-realtime-chat\\src\\firebase.js","mtime":1709885820998},{"path":"C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\appchat\\vue-realtime-chat\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709867558250},{"path":"C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\appchat\\vue-realtime-chat\\node_modules\\babel-loader\\lib\\index.js","mtime":1709867558242},{"path":"C:\\Users\\tuantv\\Desktop\\StudyCode\\Intern\\appchat\\vue-realtime-chat\\node_modules\\eslint-loader\\index.js","mtime":1709867596137}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzovVXNlcnMvdHVhbnR2L0Rlc2t0b3AvU3R1ZHlDb2RlL0ludGVybi9hcHBjaGF0L3Z1ZS1yZWFsdGltZS1jaGF0L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovVXNlcnMvdHVhbnR2L0Rlc2t0b3AvU3R1ZHlDb2RlL0ludGVybi9hcHBjaGF0L3Z1ZS1yZWFsdGltZS1jaGF0L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IGZpcmViYXNlIGZyb20gJ2ZpcmViYXNlL2FwcCc7CmltcG9ydCAnZmlyZWJhc2UvYXV0aCc7CmltcG9ydCAnZmlyZWJhc2UvZmlyZXN0b3JlJzsKaW1wb3J0IEZpbHRlciBmcm9tICdiYWQtd29yZHMnOwppbXBvcnQgeyByZWYsIG9uVW5tb3VudGVkLCBjb21wdXRlZCB9IGZyb20gJ3Z1ZSc7CmZpcmViYXNlLmluaXRpYWxpemVBcHAoewogIGFwaUtleTogIkFJemFTeUFwQS04ZTBRaGoyQ25GWE0zZzNzWDBQOXY1bm84T05iWSIsCiAgYXV0aERvbWFpbjogInRlc3QtZmlyZWJhc2UtMi1lZWYxYy5maXJlYmFzZWFwcC5jb20iLAogIGRhdGFiYXNlVVJMOiAiaHR0cHM6Ly90ZXN0LWZpcmViYXNlLTItZWVmMWMtZGVmYXVsdC1ydGRiLmFzaWEtc291dGhlYXN0MS5maXJlYmFzZWRhdGFiYXNlLmFwcCIsCiAgcHJvamVjdElkOiAidGVzdC1maXJlYmFzZS0yLWVlZjFjIiwKICBzdG9yYWdlQnVja2V0OiAidGVzdC1maXJlYmFzZS0yLWVlZjFjLmFwcHNwb3QuY29tIiwKICBtZXNzYWdpbmdTZW5kZXJJZDogIjc2NTIxNDk2OTE0OCIsCiAgYXBwSWQ6ICIxOjc2NTIxNDk2OTE0ODp3ZWI6MDJjNjRmZjIxYWJkOGM5OWZhMjIzOSIsCiAgbWVhc3VyZW1lbnRJZDogIkctVkg1SkNKUVQxRSIKfSk7CnZhciBhdXRoID0gZmlyZWJhc2UuYXV0aCgpOwpleHBvcnQgZnVuY3Rpb24gdXNlQXV0aCgpIHsKICB2YXIgdXNlciA9IHJlZihudWxsKTsKICB2YXIgdW5zdWJzY3JpYmUgPSBhdXRoLm9uQXV0aFN0YXRlQ2hhbmdlZChmdW5jdGlvbiAoX3VzZXIpIHsKICAgIHJldHVybiB1c2VyLnZhbHVlID0gX3VzZXI7CiAgfSk7CiAgb25Vbm1vdW50ZWQodW5zdWJzY3JpYmUpOwogIHZhciBpc0xvZ2luID0gY29tcHV0ZWQoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHVzZXIudmFsdWUgIT09IG51bGw7CiAgfSk7CgogIHZhciBzaWduSW4gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogICAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBnb29nbGVQcm92aWRlcjsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGdvb2dsZVByb3ZpZGVyID0gbmV3IGZpcmViYXNlLmF1dGguR29vZ2xlQXV0aFByb3ZpZGVyKCk7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIGF1dGguc2lnbkluV2l0aFBvcHVwKGdvb2dsZVByb3ZpZGVyKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSk7CgogICAgcmV0dXJuIGZ1bmN0aW9uIHNpZ25JbigpIHsKICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfSgpOwoKICB2YXIgc2lnbk91dCA9IGZ1bmN0aW9uIHNpZ25PdXQoKSB7CiAgICByZXR1cm4gYXV0aC5zaWduT3V0KCk7CiAgfTsKCiAgcmV0dXJuIHsKICAgIHVzZXI6IHVzZXIsCiAgICBpc0xvZ2luOiBpc0xvZ2luLAogICAgc2lnbkluOiBzaWduSW4sCiAgICBzaWduT3V0OiBzaWduT3V0CiAgfTsKfQp2YXIgZmlyZXN0b3JlID0gZmlyZWJhc2UuZmlyZXN0b3JlKCk7CnZhciBtZXNzYWdlc0NvbGxlY3Rpb24gPSBmaXJlc3RvcmUuY29sbGVjdGlvbignbWVzc2FnZXMnKTsKdmFyIG1lc3NhZ2VzUXVlcnkgPSBtZXNzYWdlc0NvbGxlY3Rpb24ub3JkZXJCeSgnY3JlYXRlZEF0JywgJ2Rlc2MnKS5saW1pdCgxMDApOwp2YXIgZmlsdGVyID0gbmV3IEZpbHRlcigpOwpleHBvcnQgZnVuY3Rpb24gdXNlQ2hhdCgpIHsKICB2YXIgbWVzc2FnZXMgPSByZWYoW10pOwogIHZhciB1bnN1YnNjcmliZSA9IG1lc3NhZ2VzUXVlcnkub25TbmFwc2hvdChmdW5jdGlvbiAoc25hcHNob3QpIHsKICAgIG1lc3NhZ2VzLnZhbHVlID0gc25hcHNob3QuZG9jcy5tYXAoZnVuY3Rpb24gKGRvYykgewogICAgICByZXR1cm4gX29iamVjdFNwcmVhZCh7CiAgICAgICAgaWQ6IGRvYy5pZAogICAgICB9LCBkb2MuZGF0YSgpKTsKICAgIH0pLnJldmVyc2UoKTsKICB9KTsKICBvblVubW91bnRlZCh1bnN1YnNjcmliZSk7CgogIHZhciBfdXNlQXV0aCA9IHVzZUF1dGgoKSwKICAgICAgdXNlciA9IF91c2VBdXRoLnVzZXIsCiAgICAgIGlzTG9naW4gPSBfdXNlQXV0aC5pc0xvZ2luOwoKICB2YXIgc2VuZE1lc3NhZ2UgPSBmdW5jdGlvbiBzZW5kTWVzc2FnZSh0ZXh0KSB7CiAgICBpZiAoIWlzTG9naW4udmFsdWUpIHJldHVybjsKICAgIHZhciBfdXNlciR2YWx1ZSA9IHVzZXIudmFsdWUsCiAgICAgICAgcGhvdG9VUkwgPSBfdXNlciR2YWx1ZS5waG90b1VSTCwKICAgICAgICB1aWQgPSBfdXNlciR2YWx1ZS51aWQsCiAgICAgICAgZGlzcGxheU5hbWUgPSBfdXNlciR2YWx1ZS5kaXNwbGF5TmFtZTsKICAgIG1lc3NhZ2VzQ29sbGVjdGlvbi5hZGQoewogICAgICB1c2VyTmFtZTogZGlzcGxheU5hbWUsCiAgICAgIHVzZXJJZDogdWlkLAogICAgICB1c2VyUGhvdG9VUkw6IHBob3RvVVJMLAogICAgICB0ZXh0OiBmaWx0ZXIuY2xlYW4odGV4dCksCiAgICAgIGNyZWF0ZWRBdDogZmlyZWJhc2UuZmlyZXN0b3JlLkZpZWxkVmFsdWUuc2VydmVyVGltZXN0YW1wKCkKICAgIH0pOwogIH07CgogIHJldHVybiB7CiAgICBtZXNzYWdlczogbWVzc2FnZXMsCiAgICBzZW5kTWVzc2FnZTogc2VuZE1lc3NhZ2UKICB9Owp9"},{"version":3,"sources":["C:/Users/tuantv/Desktop/StudyCode/Intern/appchat/vue-realtime-chat/src/firebase.js"],"names":["firebase","Filter","ref","onUnmounted","computed","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","auth","useAuth","user","unsubscribe","onAuthStateChanged","_user","value","isLogin","signIn","googleProvider","GoogleAuthProvider","signInWithPopup","signOut","firestore","messagesCollection","collection","messagesQuery","orderBy","limit","filter","useChat","messages","onSnapshot","snapshot","docs","map","doc","id","data","reverse","sendMessage","text","photoURL","uid","displayName","add","userName","userId","userPhotoURL","clean","createdAt","FieldValue","serverTimestamp"],"mappings":"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","sourcesContent":["import firebase from 'firebase/app'\r\nimport 'firebase/auth'\r\nimport 'firebase/firestore'\r\n\r\nimport Filter from 'bad-words'\r\nimport { ref, onUnmounted, computed } from 'vue'\r\n\r\nfirebase.initializeApp({\r\n  apiKey: \"AIzaSyApA-8e0Qhj2CnFXM3g3sX0P9v5no8ONbY\",\r\n  authDomain: \"test-firebase-2-eef1c.firebaseapp.com\",\r\n  databaseURL: \"https://test-firebase-2-eef1c-default-rtdb.asia-southeast1.firebasedatabase.app\",\r\n  projectId: \"test-firebase-2-eef1c\",\r\n  storageBucket: \"test-firebase-2-eef1c.appspot.com\",\r\n  messagingSenderId: \"765214969148\",\r\n  appId: \"1:765214969148:web:02c64ff21abd8c99fa2239\",\r\n  measurementId: \"G-VH5JCJQT1E\"\r\n})\r\n\r\nconst auth = firebase.auth()\r\n\r\nexport function useAuth() {\r\n  const user = ref(null)\r\n  const unsubscribe = auth.onAuthStateChanged(_user => (user.value = _user))\r\n  onUnmounted(unsubscribe)\r\n  const isLogin = computed(() => user.value !== null)\r\n\r\n  const signIn = async () => {\r\n    const googleProvider = new firebase.auth.GoogleAuthProvider()\r\n    await auth.signInWithPopup(googleProvider)\r\n  }\r\n  const signOut = () => auth.signOut()\r\n\r\n  return { user, isLogin, signIn, signOut }\r\n}\r\n\r\nconst firestore = firebase.firestore()\r\nconst messagesCollection = firestore.collection('messages')\r\nconst messagesQuery = messagesCollection.orderBy('createdAt', 'desc').limit(100)\r\nconst filter = new Filter()\r\n\r\nexport function useChat() {\r\n  const messages = ref([])\r\n  const unsubscribe = messagesQuery.onSnapshot(snapshot => {\r\n    messages.value = snapshot.docs\r\n      .map(doc => ({ id: doc.id, ...doc.data() }))\r\n      .reverse()\r\n  })\r\n  onUnmounted(unsubscribe)\r\n\r\n  const { user, isLogin } = useAuth()\r\n  const sendMessage = text => {\r\n    if (!isLogin.value) return\r\n    const { photoURL, uid, displayName } = user.value\r\n    messagesCollection.add({\r\n      userName: displayName,\r\n      userId: uid,\r\n      userPhotoURL: photoURL,\r\n      text: filter.clean(text),\r\n      createdAt: firebase.firestore.FieldValue.serverTimestamp()\r\n    })\r\n  }\r\n\r\n  return { messages, sendMessage }\r\n}\r\n"]}]}